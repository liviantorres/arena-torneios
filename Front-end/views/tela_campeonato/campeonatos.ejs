<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Arena Torneios</title>
  <link rel="shortcut icon" href="/logo.png">
  <link rel="stylesheet" type="text/css" href="./estilização.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>


<style>
  .descricao {
    height: 150px;
    margin-top: 30px;
    background-color: #333361;
    padding: 20px;
    text-align: justify;
  }

  .formaCompeticao {
    background-color: #333361;
    padding: 10px;
  }

  .times {
    background-color: #202028;
    height: 410px;
    padding: 40px;
  }

  .group {
    display: flex;
    line-height: 28px;
    align-items: center;
    position: relative;
  }

  .input {
    height: 40px;
    line-height: 28px;
    padding: 0 1rem;
    padding-left: 2.5rem;
    border: 2px solid transparent;
    border-radius: 4px;
    outline: none;
    background-color: #f3f3f4;
    color: #0d0c22;
    transition: .3s ease;
    width: 100%;
  }

  .input::placeholder {
    color: #9e9ea7;
  }

  .input:focus,
  input:hover {
    outline: none;
    border-color: rgba(234, 76, 137, 0.4);
    background-color: #fff;
    box-shadow: 0 0 0 4px rgb(234 76 137 / 10%);
  }

  .icon {
    position: absolute;
    left: 1rem;
    fill: #9e9ea7;
    width: 1rem;
    height: 1rem;
  }

  .mensagem {
    text-align: center;
    margin-top: 100px;
  }

  #overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
  }

  #overlay2 {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
  }

  #overlay3 {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
  }

  #overlay200 {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
  }

  .imagem {
    width: 130px;
    height: 125px;
    border-radius: 5px;
    background-color: white;

  }

  .info {
    padding: 10px;
    background-color: #333361;
  }

  .fundoimagem {
    background-color: #333361;
    height: 160px;
    padding: 20px;
  }

</style>


<body style="background-color: #0d0d26;">
  <nav class="navbar navbar-expand-lg" style="background-color: #040428;">
    <div class="container-fluid">
      <a class="navbar-brand" style="margin-left: 15px;" href="/">
        <img src="/logo.png" alt="Logo" width="68" height="71" class="d-inline-block align-text-top">
      </a>
      <div class="container">
        <div class="row justify-content-end">
          <div class="col-md-2" style="margin-top: 20px;">
            <div class="custom-text">
              <a href="/campeonato">
                <b> Meus Campeonatos </b></a>
            </div>
          </div>
          <div class="col-md-1">
            <a href="/">
              <img src="/avatar.png" width="80px" height="80px" alt="Sua Imagem"></a>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <div class="container-xl text-light"
  style="margin-top: 40px; height: 670px; background-color: #161642; margin-bottom: 50px; padding: 40px; position: relative;">
<a href="/campeonato">
  <img id="fecharJanela" src="/x.png" alt="Fechar"
    style="position: absolute; top: 10px; right: 10px; width: 25px; height: 25px; cursor: pointer;">
  </a>
  <div class="perfil d-flex align-items-center">
      <img src="/trofeubranco.png" alt="troféu">
      <h1 class="mb-0 ms-3">#<%=campeonato.nome%>
      </h1>
    </div>
    <hr style="opacity: 100%; margin-top: 4px;">
    <div class="row">
      <div class="col-sm-7 p-3">
        <form>
          <div class="mb-3">
            <div class="perfil d-flex" style="font-size: 24px;"><b>Descrição</b></div>
            <hr style="opacity: 100%; margin-top: 0px;">
            <div class="descricao" id="Textarea">
              <%=campeonato.descricao%>
            </div>
          </div>
          <div class="mb-3">
            <div class="perfil d-flex" style="font-size: 24px;"><b>Forma de Competição</b></div>
            <hr style="opacity: 100%; margin-top: 0px;">
            <div class="formaCompeticao" id="Textarea">
              <%= campeonato.forma_competicao%>
            </div>
          </div>
          <div class="mb-3">
            <div class="perfil d-flex" style="font-size: 24px;"><b>Premiação</b></div>
            <hr style="opacity: 100%; margin-top: 0px;">
            <div class="premiacao" id="Textarea">
              <%= campeonato.premiacao%>
            </div>
          </div>
          <div class="d-grid gap-2 col-12 mx-auto">
            <button class="btn btn-dark" type="button" id="timesad" style="color: #464646;">
              <b>PARTIDAS</b></button>
          </div>
        </form>
      </div>
      <div class="col"><br>
        <div class="perfil d-flex" style="font-size: 24px;"><b>Equipes</b></div>
        <hr style="opacity: 100%; margin-top: 0px;"><br>
        <div class="times">
          <div class="group">
            <svg class="icon" aria-hidden="true" viewBox="0 0 24 24">
              <g>
                <path
                  d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z">
                </path>
              </g>
            </svg>
            <input placeholder="Search" type="search" class="input">
          </div>
          <div class="d-grid gap-2 col-12 mx-auto">
            <% if (campeonato.times.length < campeonato.quantidade_times) { %>
              <button class="btn btn-warning" type="button" id="timesadicionar"
                style="color: #4d3601; --bs-btn-hover-bg: #A57300; margin-top: 10px;">
                <b>ADICIONAR EQUIPE</b>
                </button>
                <% } else { %>
                  <div class="mensagem">Limite máximo de times atingido</div>
                  <% } %>
          <div>
            <% if (campeonato.times.length> 0) { %>
              <% campeonato.times.forEach((time,i)=> { %>
                <p>
                  <%= i+1 %>
                  <a href="/time/<%=time._id%>">
                    <%= time.nome %>
                  </a>
                    <%= time.abreviacao %>
                </p>
          
                <% }); %>
            
                  <% } else { %>
                    <div class="mensagem">Ainda não há equipes</div>
                    <% } %>
              <% if (campeonato.times.length===campeonato.quantidade_times) { %>
                <button class="btn btn-warning" type="button" id="excluirTimes"> Excluir equipes</button>
                <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="overlay3">
    <div class="container text-light col-lg-3 position-absolute" style="margin-top: 40px;  width: 700px; height: 380px; background-color:
                #161642; padding: 45px; ">
      <img id="janelatimeclose" src="/x.png" alt="Fechar"
        style="position: absolute; top: 10px; right: 10px; width: 25px; height: 25px; cursor: pointer;">
        <!-- method="post" action="/time/<%=campeonato._id%>"-->
        <form>
        <div class="perfil d-flex align-items-center ">
          <img src="/icon camiseta.png" alt="camiseta">
          <h1 class="mb-0 ms-3">#<%=campeonato.times.length + 1%> Novo Time</h1>
        </div><br>
        <hr style="opacity: 100%; margin-top: 5px;">
        <div class="container">
          <div class="row ">
            <div class="col-sm-3">
              <label class="form-label">Brasão:</label>
              <div class="imagem" name="brasao">
                <button type="button" id="logoContainer"><img id="logoContainer" src="/logo.png" width="130px"
                    height="125px"></button>
              </div>

      </div>
      <div class="col">
        <div class="mb-3">
          <label class="form-label">Nome:</label>
          <input name="nome" type="text" class="form-control" id="nome" aria-describedby="emailHelp">
        </div>
        <div class="mb-3">
          <label class="form-label">Abreviação (3 letras Maiúsculas):</label>
          <input name="abreviacao" type="text" class="form-control" id="abreviacao" aria-describedby="emailHelp">
        </div>
      </div>
      <div class="d-grid gap-2 col-12 mx-auto">
        <button class="btn btn-warning" type="submit" id="timesadicionar2"
          style="color: #4d3601; --bs-btn-hover-bg: #A57300; margin-top: 10px;">
          <b>ADICIONAR EQUIPE</b>
        </button>
        </div>
        </div>
        </div>
      </form>
      </div>
      </div>
<!--     SOBREPOSIÇÃO DE url-->
<div id="overlay">
  <div class="container-xxl text-light col-lg-3 position-absolute" style="margin-top: 40px;  height: 180px; background-color:
     #161642; padding: 20px; ">
    <img id="fecharurl" src="/x.png" alt="Fechar"
      style="position: absolute; top: 10px; right: 10px; width: 25px; height: 25px; cursor: pointer;">
    <form>
      <div class="container">
        <form>
          <div class="mb-3">
            <label class="form-label">URL:</label>
            <input type="email" class="form-control" id="brasao" name="brasao" aria-describedby="emailHelp">
            </div>
            <div class="d-grid gap-2 col-12 mx-auto">
              <button class="btn btn-warning" type="button" id="salvarUrl" style="color: #4d3601; --bs-btn-hover-bg: #A57300;">
                <b>SALVAR</b></button>
              </div>
              </div>
              </div>
              </form>
              </div>
              </div>
            </form>
    </div>
</div>
  </div>

<script>

  document.getElementById('timesadicionar').addEventListener('click', function () {
    if (document.getElementById('overlay3').style.display === 'flex' || document.getElementById('overlay3').style.display === '') {
      document.getElementById('overlay3').style.display = 'none';
    } else {
      document.getElementById('overlay3').style.display = 'flex';
    }
  });

        document.getElementById('janelatimeclose').addEventListener('click', function () {
      document.getElementById('overlay3').style.display = 'none';
      });

                  document.getElementById('logoContainer').addEventListener('click', function () {
                    if (document.getElementById('overlay').style.display === 'block') {
                      document.getElementById('overlay').style.display = 'none';
                    } else {
                      document.getElementById('overlay').style.display = 'block';
                    }
  });

  document.getElementById('fecharurl').addEventListener('click', function () {
    document.getElementById('overlay').style.display = 'none';
  });

                  document.getElementById('salvarUrl').addEventListener('click', function () {
                  var brasao = document.getElementById('brasao').value;
                  document.getElementById('logoContainer').innerHTML = '<img src="' + brasao + '" width="130px" height="125px">';
                  document.getElementById('overlay').style.display = 'none';
                });

                  document.getElementById('logo').addEventListener('click', function () {
                    document.getElementById('overlay').style.display = 'block';
                  });


</script>
              
<script>
 


  document.getElementById('timesadicionar2').addEventListener('click', function () {
    var brasao = document.getElementById('brasao').value;
    var nome = document.getElementById('nome').value;
    var abreviacao = document.getElementById('abreviacao').value;

    document.getElementById('logoContainer').innerHTML = '<img src="' + brasao + '" width="130px" height="125px">';
    document.getElementById('overlay').style.display = 'none';

    
    $.ajax({
      url: '/time/<%=campeonato._id%>',  
      data: { nome: nome, abreviacao: abreviacao, brasao: brasao },
      success: function (response) { 
        console.log('Dados enviados com sucesso!');
      },
      error: function (error) {
        console.error('Erro ao enviar dados para o backend:', error);
      }
    });
  });

</script>

<script>

  document.getElementById('excluirTimes').addEventListener('click', function () {
    var campeonatoId = '<%=campeonato._id%>';
    
    var xhr = new XMLHttpRequest();
    xhr.open('DELETE', '/campeonato/' + campeonatoId + '/times', true);
    xhr.onreadystatechange = function () {
      if (xhr.readyState == 4) {
        if (xhr.status == 200) {
         
          console.log('Times excluídos com sucesso.');
        } else {
          console.error('Erro ao excluir times:', xhr.statusText);
        }
      }
    };
    xhr.send();
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
  crossorigin="anonymous"></script>

</body>

</html>